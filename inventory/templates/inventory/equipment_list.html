{% extends "base.html" %}
{% block title %}Оборудование{% endblock %}
{% block content %}
<h1>Оборудование</h1>

<div class="filter no-print">
  <form method="get">
    {{ filter.form.as_p }}
    <button type="submit">Фильтровать</button>
    <a href="{% url 'inventory:equipment_list' %}">Сброс</a>
    <span style="float:right">
{#      <a href="{% url 'inventory:equipment_print' %}?{{ request.GET.urlencode }}">Печать текущего фильтра</a>#}
        <a href="{% url 'inventory:equipment_list_pdf' %}?{{ request.GET.urlencode }}">PDF по текущему фильтру</a>
    </span>
  </form>
</div>

<p class="muted">Найдено: {{ page_obj.paginator.count }}</p>

<table>
  <thead>
    <tr>
      <th>Наименование</th>
      <th>Тип</th>
      <th>Инв. №</th>
      <th>№ ПК</th>
      <th>Статус</th>
      <th>Закреплено</th>
      <th>Организация</th>
      <th class="no-print">Действия</th>
    </tr>
  </thead>
  <tbody>
  {% for obj in page_obj %}
    <tr>
      <td><a href="{% url 'inventory:equipment_detail' obj.pk %}">{{ obj.name }}</a><div class="muted">{{ obj.model }} {{ obj.serial_number }}</div></td>
      <td>{{ obj.equipment_type }}</td>
      <td>{{ obj.inventory_number|default:"—" }}</td>
      <td>{{ obj.pc_number|default:"—" }}</td>
      <td>{{ obj.get_status_display }}</td>
      <td>{{ obj.assigned_to|default:"—" }}</td>
      <td>{{ obj.organization }}</td>
      <td class="no-print actions">
        <a href="{% url 'inventory:equipment_qr_label' obj.pk %}">Этикетка QR</a>
        <a href="{% url 'inventory:equipment_qr_png' obj.pk %}">QR PNG</a>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="8">Нет данных</td></tr>
  {% endfor %}
  </tbody>
</table>

{% if is_paginated %}
  <div class="no-print" style="margin-top:12px;">
    {% if page_obj.has_previous %}
      <a href="?{% querystring request.GET 'page' page_obj.previous_page_number %}">Назад</a>
    {% endif %}
    <span>стр. {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?{% querystring request.GET 'page' page_obj.next_page_number %}">Вперед</a>
    {% endif %}
  </div>
{% endif %}
{% endblock %}